sudo: required

env:
  - IMAGE_NAME="golang:staging"
  # - IMAGE_NAME="gcr.io/nick-cloudbuild/check_if_tag_exists"


services:
- docker

# before_install:
#   - sudo apt-get update -qq
#   - sudo apt-get install apt-transport-https ca-certificates
#   - sudo apt-key adv --keyserver hkp://p80.pool.sks-keyservers.net:80 --recv-keys 58118E89F3A912897C070ADBF76221572C52609D
#   - echo "deb https://apt.dockerproject.org/repo ubuntu-trusty main" | sudo tee /etc/apt/sources.list.d/docker.list
#   - sudo apt-get update -qq
#   - sudo apt-get install -o Dpkg::Options::="--force-confnew" -y --force-yes docker-engine=1.9.1-0~trusty

script:
- curl https://raw.githubusercontent.com/nkubala/runtimes-common/travis_test/structure_tests/ext_run.sh > ext_run.sh
- chmod +x ext_run.sh
# - docker version
- docker build -t "$IMAGE_NAME" -q base/
- ./ext_run.sh -i "$IMAGE_NAME" -v --config test/test_config.json
